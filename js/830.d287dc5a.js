"use strict";(self["webpackChunkjanereka_ryru"]=self["webpackChunkjanereka_ryru"]||[]).push([[830],{830:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var i=a(3673),s=a(2323),o=a(8880);const l={key:0,class:"side-frame column no-wrap absolute-right col-xs-10 col-sm-8 col-md-3 q-px-md q-pa-md bg-white z-top",style:{"overflow-y":"scroll"}},n={class:"column q-my-md"};function r(e,t,a,r,d,g){const h=(0,i.up)("main-table"),c=(0,i.up)("q-icon"),m=(0,i.up)("q-btn"),p=(0,i.up)("q-input"),u=(0,i.up)("q-radio"),y=(0,i.up)("tag-cloud"),w=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(w,{padding:"",class:"row"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{ref:"galleryTable",loading:d.loading,midias:d.mediaItems,viewingFrom:"mainGallery",allowMediaEdition:g.isAdmin,onFilterContent:g.filterContent,onChangePage:t[0]||(t[0]=e=>g.requestPage(e)),onToggleFilter:t[1]||(t[1]=e=>d.showFilter=!d.showFilter),onCloseMenus:t[2]||(t[2]=e=>d.showFilter=!1),class:(0,s.C_)([{"col-xs-12 col-md-9":d.showFilter},{fit:!d.showFilter}]),style:{transition:"0.3s ease"}},null,8,["loading","midias","allowMediaEdition","onFilterContent","class"]),(0,i.Wm)(o.uT,{appear:"","enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOutRight"},{default:(0,i.w5)((()=>[d.showFilter?((0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(p,{filled:"",dense:"",modelValue:d.keywords,"onUpdate:modelValue":t[4]||(t[4]=e=>d.keywords=e),placeholder:e.$t("gallery.searchBarPlaceholder"),onKeydown:t[5]||(t[5]=(0,o.D2)((0,o.iM)((e=>g.getMediasByKeywords(d.keywords)),["prevent"]),["enter"])),debounce:"300",standout:"bg-grey-2",class:"q-my-lg"},{append:(0,i.w5)((()=>[(0,i.Wm)(m,{flat:"",dense:"",type:"submit",onClick:t[3]||(t[3]=e=>g.getMediasByKeywords(d.keywords))},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{name:"search"})])),_:1})])),_:1},8,["modelValue","placeholder"]),(0,i._)("strong",null,(0,s.zw)(e.$t("gallery.menuSortBy")),1),(0,i._)("div",n,[(0,i.Wm)(u,{modelValue:d.sortingOption,"onUpdate:modelValue":t[6]||(t[6]=e=>d.sortingOption=e),val:"alphabetical",label:e.$t("gallery.menuSortAlphabetical"),onInput:t[7]||(t[7]=e=>g.applySorting(d.sortingOption))},null,8,["modelValue","label"]),(0,i.Wm)(u,{modelValue:d.sortingOption,"onUpdate:modelValue":t[8]||(t[8]=e=>d.sortingOption=e),val:"newer",label:e.$t("gallery.menuSortNewer"),onInput:t[9]||(t[9]=e=>g.applySorting(d.sortingOption))},null,8,["modelValue","label"]),(0,i.Wm)(u,{modelValue:d.sortingOption,"onUpdate:modelValue":t[10]||(t[10]=e=>d.sortingOption=e),val:"older",label:e.$t("gallery.menuSortOlder"),onInput:t[11]||(t[11]=e=>g.applySorting(d.sortingOption))},null,8,["modelValue","label"])]),(0,i.Wm)(y,{hashtags:d.hashtags,onFindHashtag:g.getMediasByHashtag},null,8,["hashtags","onFindHashtag"]),(0,i.Wm)(m,{label:e.$t("gallery.buttonLabelClose"),color:"primary",class:"self-start q-mt-xl",onClick:t[12]||(t[12]=e=>d.showFilter=!1)},null,8,["label"])])):(0,i.kq)("",!0)])),_:1})])),_:1})}a(71);var d=a(1098),g=a(3549);const h={name:"Acervo",components:{MainTable:()=>Promise.all([a.e(736),a.e(64),a.e(404)]).then(a.bind(a,1292)),TagCloud:()=>a.e(187).then(a.bind(a,6187))},data(){return{mediaManager:d.b.getManager(),sessionData:g.$.session(),mediaItems:[],hashtags:[],loading:!1,showFilter:!1,sortingOption:"",keywords:""}},mounted(){this.getTopHashtags(),this.filterContent("todos")},computed:{isAdmin:function(){return this.sessionData.roles.includes("acervo.publisher")}},methods:{async getTopHashtags(){const{data:e}=await this.$axios.get("/acervo/top_tags?size=20");this.hashtags=e},async getMediasByHashtag(e){this.loading=!0,this.showFilter=!1,this.sortingOption="",this.$refs.galleryTable.defaultTab();const t=await this.mediaManager.getMediasByHashtag(e);t?(this.mediaItems=t,this.loading=!1):(this.loading=!1,this.$q.notify({type:"negative",message:this.$t("gallery.alertGenericError"),actions:[{icon:"close",color:"white"}]}))},async getMediasByKeywords(e){this.loading=!0,this.showFilter=!1,this.sortingOption="";const t=await this.mediaManager.getMediasByKeywords(e);t?(this.mediaItems=t,this.loading=!1):(this.loading=!1,this.$q.notify({type:"negative",message:this.$t("gallery.alertGenericError"),actions:[{icon:"close",color:"white"}]}))},async filterContent(e){this.loading=!0,this.sortingOption="";const t=await this.mediaManager.getMediasByContentType(e);t?(this.mediaItems=t,this.loading=!1):(this.loading=!1,this.$q.notify({type:"negative",message:this.$t("gallery.alertGenericError"),actions:[{icon:"close",color:"white"}]}))},async applySorting(e){this.loading=!0;const t=await this.mediaManager.applyMediaSorting(e);t.success?(this.mediaItems=t.data,this.loading=!1):(this.loading=!1,this.sortingOption="",this.$q.notify({type:"negative",message:this.$t("gallery.alertGenericError"),actions:[{icon:"close",color:"white"}]}))},requestPage(e){const{pageNumber:t,midiaType:a}=e;console.log(t,a)}}};var c=a(4260),m=a(4379),p=a(4689),u=a(8240),y=a(4554),w=a(7991),b=a(7518),f=a.n(b);const v=(0,c.Z)(h,[["render",r]]),M=v;f()(h,"components",{QPage:m.Z,QInput:p.Z,QBtn:u.Z,QIcon:y.Z,QRadio:w.Z})}}]);